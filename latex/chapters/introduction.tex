% !TeX spellcheck = en_US

\chapter{Introduction}

	Web browsers are a common tool nowadays to interact with the world wide web. They allow a user to view web content, interact with web applications, and communicate with others around the world. To enhance this interaction, browsers support extensions that can change the look and behavior of web pages and add further functionality to the browser. For that purpose, the browser provides additional interfaces to its extensions that provide access to browser-internal features such as the user's bookmarks, stored cookies, or additional user interfaces.
	
	The wide range of functionality that a browser provides to its extension is unfortunately used by criminals to attack the extension's user. They implement and distribute malicious extensions such as \textit{Febipos} or \textit{Kilim} which target the user's social media accounts and spread spamming content without the user's consent \cite{febipos, kilim}. Both are known to security vendors and modern anti-virus software is configured to detect and remove them. \\
	But not only anonymous attacker misuse browser extensions. The popular extension \textit{Hola} which currently has about 9 million users received negative publicity after its botnet-like behavior was uncovered. The extension's base functionality allows to bypass regional restrictions on web content by routing the user's requests to other users of their network for who the restrictions do not apply. This creates a VPN-like network that masks the origin of the user's requests but with the difference that each defaulting customer acts as an endpoint for the network. Therefore, the user is regularly exposed to the open Internet by traffic from other users that took on his IP address. Furthermore, the company behind the extension did not inform their users about a second service that allows paying customers to route targeted traffic through the network until the operator of a web platform claimed that the network was used to execute DDoS attacks against his servers \cite{holaFaqRewrite, 8chanHola}. This incident triggered several security analysis of the network and the used software which confirmed the botnet-like behavior \cite{vectraHola}. \\
	
	With our work, we want to show the threats that arise from browser extensions and that existing extensions already have the privileges to implement malicious behavior. To increase the scope of our work, we focus an extension architecture that is supported by most modern browsers: Google's \textit{Chrome} browser, Mozilla's \textit{Firefox} browser, Microsoft's \textit{Edge} browser, and the \textit{Opera} browser.
	
	\autoref{tab:browserShare} shows browser usage statistics from different companies \cite{w3browserStats, statcounter, netmarketshare}. These provide frameworks that other websites include and are therefore able to collect user information from many different web pages. A general and exact statistic about browser usage is currently not possible, because the browsers' companies do not publish the numbers of active users. The presented statistics show that our work is currently applicable to extensions from around 70\% of browser users.

	\begin{table}
		\centering
		\begin{tabular}{|l|l|l|l|}
			\hline
			\textbf{Browser} & \textbf{w3counter} & \textbf{StatCounter} & \textbf{NetMarketShare} \\ \hline
			Chrome & 59.5\% & 62.38\% & 50.95\% \\ \hline
			Internet Explorer & 8.6\% & 10.73\% & 29.60\% \\ \hline
			Firefox & 10.1\% & 15.43\% & 8.12\% \\ \hline
			Safari & 13.1\% & 4.59\% & 4.51\% \\  \hline
			Opera & 2.6\% & - & 1.40\% \\ \hline
			Edge & 1.6\% & 3.04\% & 5.09\% \\ \hline
		\end{tabular}
		\caption{Different statistics about the global browser share of July 2016 \cite{w3browserStats, statcounter, netmarketshare}}
		\label{tab:browserShare}
	\end{table}	
	
\section{Contribution}
	
	In our work, we show that a browser extension posse a threat to the user's privacy and can be use to intentionally harm him. For that purpose, we conducted a threat analysis of extensions and their capabilities. As a proof-of-concept, we designed a system to integrate malicious behavior into existing extensions. Our design consists of interchangeable components that we can integrate in another extension if the extension's declared and the component's needed privileges match each other. This allows us to integrate malicious behavior into a presumably benign extension without the need for a change in the extension's privileges which will be displayed on its installation and update. \\
	Finally, we show that our design is indeed applicable to existing extensions. We fetched several extensions with a high number of users and analyzed their privileges. We discovered that many extensions are very complex and provide a bulk of features which results in many needed permissions and thus facilitates the integration of our components. 

\section{Outline}

	The remainder of this paper is structured as follows. In \autoref{chp:relatedWorks} we review related works to our topic which include the extension architecture that we focus in our work (\autoref{sec:relatedWorks:extensionArchitecture}), threat analysis of malicious browser extensions (\autoref{sec:relatedWorks:threatAnalysis}), and the detection of malicious extensions (\autoref{sec:relatedWorks:detectionOfMaliciousExtensions}). 
	We provide additional background information in \autoref{chp:background} including probably less known terminology that we use in our paper in \autoref{sec:terminology} and an overview of the extension architecture that we focus in \autoref{sec:extensionArchitecture}. 
	In \autoref{chp:threatAnalysis}, we present the results of our theoretical threat analysis. \autoref{sec:threatAnalysis:contentScripts} contains threats that arise from the extension's full access to a displayed web page and \autoref{sec:threatAnalysis:api} contains threats that arise from the functionality provided by the browser to its extensions.
	We present our design that acts as a proof-of-concept for our theoretical analysis in \autoref{chp:design}. It consists of three steps with interchangeable components. We present common methods to identify the current user of a web page and our implemented components for that task in \autoref{sec:identification}, our components to transfer collected user information to a remote server and fetch the source code for our attack components in \autoref{sec:communication}, and finally our explicit attack components in \autoref{sec:execution}.
	In \autoref{chp:countermeasures}, we present existing and from other researchers proposed countermeasures against malicious extensions.
	Finally, we give a brief conclusion to our work in \autoref{chp:conclusion}.